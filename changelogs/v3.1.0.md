# v3.1.0 - μ¤ν”„λ§ λΉ μ΅°νλ¥Ό ν†µν• μ•λ¦Ό μ •μ±… λ™μ  μ„ νƒ (μ „λµ ν¨ν„΄ μ μ©)

## π“† λ‚ μ§

2025-07-15

---

### π“ μ”κµ¬μ‚¬ν•­

- νμ› κ°€μ… μ‹, λ“±κΈ‰(`Grade`)μ— λ”°λΌ μ„λ΅ λ‹¤λ¥Έ **μ•λ¦Ό λ°©μ‹**μ„ μ μ©ν•΄μ•Ό ν•λ‹¤.
    - μΌλ° νμ›: μ½μ†”λ΅ μ¶•ν• λ©”μ‹μ§€
    - VIP νμ›: μ΄λ©”μΌλ΅ μ¶•ν• λ©”μ‹μ§€
- ν–¥ν›„ SMS λ“± **μƒλ΅μ΄ μ •μ±… μ¶”κ°€μ— μ μ—°ν•κ² λ€μ‘** κ°€λ¥ν•΄μ•Ό ν•λ‹¤.

---

### β οΈ λ¬Έμ  μƒν™©

μ΄κΈ° κµ¬ν„μ€ μ•„λμ™€ κ°™μ΄ `if` μ΅°κ±΄λ¬Έμ„ μ‚¬μ©ν•΄ `new` ν‚¤μ›λ“λ΅ μ§μ ‘ κ°μ²΄λ¥Ό μƒμ„±ν–λ‹¤:

```java
if (member.getGrade() == Grade.VIP) {
    notificationPolicy = new EmailNotificationPolicy();
} else {
    notificationPolicy = new ConsoleNotificationPolicy();
}

```

### β— μ΄λ΅ μΈν•΄ λ°μƒν• λ¬Έμ 

- β… **DIP μ„λ°**: κ³ μμ¤€ λ¨λ“(`MemberService`)μ΄ μ €μμ¤€ κµ¬ν„(`EmailNotificationPolicy`, `ConsoleNotificationPolicy`)μ— μ§μ ‘ μμ΅΄
- β… **OCP μ„λ°**: μƒλ΅μ΄ μ •μ±…μ„ μ¶”κ°€ν•λ ¤λ©΄ if-else μ΅°κ±΄λ¬Έμ„ κ³„μ† μμ •ν•΄μ•Ό ν•¨
- β… **ν…μ¤νΈ μ–΄λ ¤μ›€**: μ™Έλ¶€ μ„¤μ •μ΄λ‚ μ£Όμ… μ—†μ΄ μ½”λ“ λ‚΄μ—μ„ μ§μ ‘ κµ¬ν„μ²΄λ¥Ό μƒμ„±ν•λ―€λ΅ ν…μ¤νΈλ‚ ν™•μ¥μ΄ μ–΄λ ¤μ›€
- β… **μ¤ν”„λ§ DI λ¬΄λ ¥ν™”**: μ¤ν”„λ§ μ»¨ν…μ΄λ„κ°€ κ΄€λ¦¬ν•μ§€ μ•λ” κ°μ²΄κ°€ λ΅μ§ λ‚΄λ¶€μ— λ“±μ¥

---

### π― λ¬Έμ μ μ •ν™•ν• μ›μΈ

- `new` ν‚¤μ›λ“λ΅ μ§μ ‘ κµ¬ν„μ²΄λ¥Ό μƒμ„± β†’ μ¤ν”„λ§ μ»¨ν…μ΄λ„κ°€ κ΄€λ¦¬ν•  μ μ—†κ³ , μμ΅΄μ„± μ£Όμ…λ„ λ°›μ„ μ μ—†μ
- μ„λΉ„μ¤ μ½”λ“ λ‚΄λ¶€μ—μ„ κµ¬ν„μ²΄λ¥Ό μ„ νƒν•λ” μ΅°κ±΄ λ¶„κΈ° λ΅μ§μ΄ μ΅΄μ¬ β†’ **μ±…μ„μ΄ λ¶„μ‚°λκ³  μ μ—°μ„± μ €ν•**

---

### π”§ ν•΄κ²° λ°©ν–¥

### β… μ „λµ ν¨ν„΄ (Strategy Pattern) + μ¤ν”„λ§μ μλ™ λΉ μ£Όμ…μ„ κ²°ν•©

1. **μ •μ±… μΈν„°νμ΄μ¤**μΈ `NotificationPolicy`λ¥Ό κΈ°μ¤€μΌλ΅,
2. κ° μ •μ±… κµ¬ν„μ²΄(`EmailNotificationPolicy`, `ConsoleNotificationPolicy`)λ¥Ό `@Component`λ΅ λ“±λ΅
3. `Map<String, NotificationPolicy>`λ¥Ό ν†µν•΄ λ¨λ“  λΉμ„ μλ™ μ£Όμ…λ°›λ” `NotificationDispatcher` ν΄λμ¤ μƒμ„±
4. Dispatcherκ°€ νμ› λ“±κΈ‰μ— λ”°λΌ μ μ ν• μ „λµμ„ μ„ νƒν•μ—¬ μ‚¬μ©

---

### β… μ£Όμ” κµ¬ν„

### 1. NotificationPolicy μΈν„°νμ΄μ¤

```java
public interface NotificationPolicy {
    void notify(Member member);
}
```

### 2. κµ¬ν„μ²΄ λ“±λ΅ (@Component)

```java
@Component
public class EmailNotificationPolicy implements NotificationPolicy {
...
}

@Component
public class ConsoleNotificationPolicy implements NotificationPolicy {
...
}
```

### 3. Dispatcher κµ¬ν„

```java
@Service
public class NotificationDispatcher {

    private final Map<String, NotificationPolicy> policyMap;

    public NotificationDispatcher(Map<String, NotificationPolicy> policyMap) {
        this.policyMap = policyMap;
    }

    public void dispatch(Member member) {
        NotificationPolicy policy = selectPolicy(member);
        policy.notify(member);
    }

    private NotificationPolicy selectPolicy(Member member) {
        if (member.getGrade() == Grade.VIP) {
            return policyMap.get("emailNotificationPolicy");
        } else {
            return policyMap.get("consoleNotificationPolicy");
        }
    }
}
```

### 4. MemberServiceμ—μ„ Dispatcher μ‚¬μ©

```java
public class MemberService {
    private final NotificationDispatcher dispatcher;

    public void join(Member member) {
        ...
        dispatcher.dispatch(member);
    }
}
```

---

### π§  μ „λµ ν¨ν„΄(Strategy Pattern)μ΄λ€?

### κ°λ…

- **ν–‰λ™(μ „λµ)μ„ μΊ΅μν™”**ν•΄μ„ μ„λ΅ κµν™ κ°€λ¥ν•κ² λ§λ“λ” ν¨ν„΄
- ν΄λΌμ΄μ–ΈνΈ μ½”λ“μ—μ„ μ•κ³ λ¦¬μ¦μ„ λ¶„κΈ°ν•μ§€ μ•κ³ , **μ „λµ κ°μ²΄μ— μ„μ„**ν•¨
- ν΄λΌμ΄μ–ΈνΈλ” μ „λµμ΄ μ–΄λ–¤ κµ¬ν„μΈμ§€ **λ°λΌλ„ λ¨**

### κµ¬μ΅°

| μ—­ν•  | μ„¤λ… | μμ‹ |
| --- | --- | --- |
| `Strategy μΈν„°νμ΄μ¤` | μ•κ³ λ¦¬μ¦(μ •μ±…)μ κ³µν†µ μΈν„°νμ΄μ¤ | `NotificationPolicy` |
| `ConcreteStrategy` | μ‹¤μ  μ•κ³ λ¦¬μ¦ κµ¬ν„μ²΄ | `EmailNotificationPolicy`, `ConsoleNotificationPolicy` |
| `Context` | μ „λµ κ°μ²΄λ¥Ό λ°›μ•„μ„ μ„μ„ μ‹¤ν–‰ | `NotificationDispatcher` |

### μ¥μ 

- OCP(κ°λ°©-νμ‡„ μ›μΉ™) λ§μ΅±
- μƒλ΅μ΄ μ „λµμ„ μ¶”κ°€ν•΄λ„ ν΄λΌμ΄μ–ΈνΈ μμ • μ—†μ
- ν…μ¤νΈ, ν™•μ¥ μ©μ΄

### π§  `Map<String, T>`λ΅ μ¤ν”„λ§ λΉ μ£Όμ…λ°›κΈ°

- `Map<String, InterfaceType>` ν•νƒλ΅ μ£Όμ…ν•λ©΄, **ν•΄λ‹Ή νƒ€μ…μ λ¨λ“  λΉμ„ `{λΉ μ΄λ¦„ β†’ λΉ κ°μ²΄}` ν•νƒλ΅ μλ™ μ£Όμ…**λ°›μ„ μ μλ‹¤
- λ”°λΌμ„ λ³„λ„μ `@Qualifier`λ‚ `@Primary` μ—†μ΄λ„ **μ΄λ¦„ κΈ°λ° μ΅°ν**λ΅ κµ¬ν„μ²΄ μ„ νƒ κ°€λ¥

β… μμ‹:

```java
private final Map<String, NotificationPolicy> policyMap;
```

```java
@Component
public class EmailNotificationPolicy implements NotificationPolicy

@Component
public class ConsoleNotificationPolicy implements NotificationPolicy
```

```java
return policyMap.get("emailNotificationPolicy");
```

- μ¤ν”„λ§μ€ μ„ λ‘ μ •μ±…μ„ μλ™μΌλ΅ λ“±λ΅ν•΄

`policyMap = { "emailNotificationPolicy" β†’ κ°μ²΄, "consoleNotificationPolicy" β†’ κ°μ²΄ }`λ΅ λ§λ“¤μ–΄μ¤

---

## π’¬ μ°Έκ³  κ°•μ

- κΉ€μν• - μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬ - κΈ°λ³ΈνΈ

  (μ„Ήμ… 5: μ¤ν”„λ§ μ»¨ν…μ΄λ„μ™€ μ¤ν”„λ§ λΉ)